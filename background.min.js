var nodeData={vData:{},gData:[],getTitle:function(b,c){q="https://www.googleapis.com/youtube/v3/videos?id="+b+"&key=AIzaSyBHRUtsTAr8xvNdUdXYkydgKxo6yGWkgq4&fields=items(snippet)&part=snippet",$.ajax({url:q,dataType:"jsonp",success:function(a){nodeData.vData={id:b,title:a.items[0].snippet.title,group:c},console.log(a),console.log(name),console.log(nodeData.vData),nodeData.ajaxCall(nodeData.vData),nodeData.vData={}},error:function(a,b,c){alert(b,NaN+c)}})},ajaxCall:function(b){console.log("Running post for Node"),$.ajax({method:"POST",dataType:"json",data:b,url:"http://139.59.190.164:3000"}).done(function(a,b,c){console.log("Finished")})},getTop:function(){$.ajax({method:"GET",url:"http://139.59.190.164:3000/top"}).done(function(a,b,c){console.log("GET Finished");for(var d=0;d<a.length;d++)nodeData.getYoutubeInfo(a[d])})},getRecent:function(){$.ajax({method:"GET",url:"http://139.59.190.164:3000/recent"}).done(function(a,b,c){console.log("GET Finished"),console.log(a);for(var d=0;d<a.length;d++)nodeData.getYoutubeInfo(a[d],!0)})},ordinalData:function(){for(var b=0;b<nodeData.gData.length;b++)null===nodeData.gData[b].itemID&&nodeData.gData.splice(b,1);nodeData.gData.sort(function(a,b){return a.count-b.count}),nodeData.gData.reverse(),nodeData.chromeStorage(nodeData.gData),nodeData.getRecent()},getYoutubeInfo:function(b,c){var d;d=c===!0?b.id:b._id;null!==b&&(q="https://www.googleapis.com/youtube/v3/videos?id="+d+"&key=AIzaSyBHRUtsTAr8xvNdUdXYkydgKxo6yGWkgq4&fields=items(snippet)&part=snippet",$.ajax({url:q,dataType:"jsonp",success:function(a){c!==!0?(nodeData.gData.push({youData:a.items,itemID:b._id,count:b.count}),101===nodeData.gData.length&&nodeData.ordinalData()):(console.log("running else"),void 0===nodeData.recent&&(console.log("running"),nodeData.gData=[]),nodeData.recent=!0,nodeData.gData.push({youData:a.items,itemID:d}),100===nodeData.gData.length&&(console.log("here"),setTimeout(function(){chrome.storage.local.set({recent:nodeData.gData},function(){console.log("Settings saved")})},100)))},error:function(a,b,c){alert(b,NaN+c)}}))},chromeStorage:function(b,c){console.log("running storage"),setTimeout(function(){chrome.storage.local.set({stats:b},function(){console.log("Settings saved")})},100)},init:function(){chrome.storage.onChanged.addListener(function(a,b){var c;console.log("Changed"),chrome.storage.local.get("value",function(a){if(console.log(a),!jQuery.isEmptyObject(a)){c=a.value[0],group=a.value[2],console.log(a);for(var b=0;b<c.length;b++)nodeData.getTitle(c[b],group)}})})}},initiator={newLinkNumber:null,accessToken:null,topTen:[],validFBurl:function(b){var c=/^(http|https)\:\/\/www.facebook.com\/.*/i;b.match(c)?(nodeData.gData=[],nodeData.getTop(),console.log("success"),$(".error-message").hide(),chrome.tabs.executeScript(null,{file:"jquery-1.11.2.min.js"},function(){chrome.tabs.executeScript(null,{file:"contentScript.min.js"}),chrome.tabs.insertCSS(null,{file:"popStyle.css"})})):($(".error-message").show(),$(".scanner-loader-container").hide())}};$(document).ready(function(){chrome.browserAction.onClicked.addListener(function(a){chrome.storage.local.clear(function(){var a=chrome.runtime.lastError;a&&console.error(a)}),nodeData.recent=void 0,nodeData.vData={},chrome.identity.getAuthToken({interactive:!0},function(a){var b=a;setTimeout(function(){chrome.runtime.onConnect.addListener(function(a){a.postMessage({greeting:"hello",accessToken:b})})},100),chrome.tabs.query({active:!0,currentWindow:!0},function(a){console.log(a[0].url),console.log("working"),initiator.validFBurl(a[0].url)})})}),nodeData.init()});